#include <Wire.h>
#include <RCSwitch.h>
#include <SPI.h>
#include "SSD1306Ascii.h"
#include "SSD1306AsciiAvrI2c.h"
#include <avr/pgmspace.h>

#define SCREEN_WIDTH 128  // Oled display width 
#define SCREEN_HEIGHT 64 //  OIled display hgeight 

// Declaration for an SSD1306 display connected to I2C (SDA, SCL pins)
#define OLED_RESET     -1 // Reset pin # (or -1 if sharing Arduino reset pin)
#define I2C_ADDRESS 0x3C //0x3C or 0x3D depending on Oled configuration
SSD1306AsciiAvrI2c display;

// Create new RCSwitch instances
RCSwitch mhz433r = RCSwitch();
RCSwitch mhz433t = RCSwitch();

// Create the RF code type
typedef struct{
  int number;
  int frequency;
  unsigned long value;
  int bitlength;
  int protocol;
  int key; // Not sure if this is the same as bitlength
} rfCode;

// Used to animate "Scanning..."
int pointCount = 0; 
unsigned long scannerTimer = millis();
unsigned long refreshAfter = 250;

const uint32_t PROGMEM dB[] = {0,4096,1,268435456,1052672,17,268435456,16781312,257,268435456,17829888,273,268435456,268439552,4097,268435456,269488128,4113,268435456,285216768,4353,268435456,286265344,4369,268435457,4096,65537,268435457,1052672,65553,268435457,16781312,65793,268435457,17829888,65809,268435457,268439552,69633,268435457,269488128,69649,268435457,285216768,69889,268435457,286265344,69905,268435472,4096,17825792,268439568,4096,286261248,268501008,4097,17825792,268505104,4097,286261248,269484048,4112,17825792,269488144,4112,286261248,269549584,4113,17825792,269553680,4113,286261248,285212688,4352,17825792,285216784,4352,286261248,285278224,4353,17825792,285282320,4353,286261248,286261264,4368,17825792,286265360,4368,286261248,286326800,4369,17825792,286330896,4369,286261249,4112,65536,286261249,65552,65537,17825793,69648,65537,286261249,1048592,65552,17825793,1052688,65552,286261249,1114128,65553,17825793,1118224,65553,286261249,16777488,65792,269484033,16781584,65793,1048577,16843024,65793,269484033,16847120,65808,1048577,17826064,65808,269484033,17830160,65809,1048577,17891600,65809,269484033,17895696,69632,17825808,268435728,1118208,17826048,268435728,16846848,17826064,268435728,17895424,17829888,268435728,268505088,17829904,268435728,269553664,17830144,268435728,285282304,17830160,268435728,286330880,17891329,268435729,1052672,17891345,268435729,16781312,17891585,268435729,17829888,17891601,268435729,268439552,17895425,268435729,269488128,17895441,268435729,285216768,17895681,268435729,286265344,17895697,268439552,268439553,268439552,269488128,268439569,268439552,285216768,268439809,268439552,286265344,268439825,268439553,69632,268501008,268439553,1118208,268501248,268439553,16846848,268501264,268439553,17895424,268505089,268439553,269488128,268505105,268439553,285216768,268505345,268439553,286265344,268505361,268439568,1052672,286261264,268501008,1052673,17825808,268505104,1052673,286261264,269484304,1052688,269484048,269488400,1052689,1048592,269549840,1052689,269484048,269553936,1052928,17825808,285216784,1052928,286261264,285278224,1052929,17825808,285282320,1052929,286261264,286261520,1052944,269484048,286265616,1052945,1048592,286327056,1052945,269484048,286331152,1114113,269484049,69904,1114128,17825809,1052688,1114128,286261265,1114128,1114129,17825809,1118224,1114129,286261265,16781328,1114368,286261265,16842768,1114369,17825809,16846864,1114369,286261265,17826064,1114384,269484049,17830160,1114385,1048593,17891600,1114385,269484049,17895696,1118208,286261504,268439824,16846848,286261520,268439824,17895424,286265345,268439824,269488128,286265361,268439824,285216768,286265601,268439824,286265344,286265617,268439825,1052672,286326801,268439825,16781312,286327041,268439825,17829888,286327057,268439825,268505088,286330896,268439825,269553664,286331136,268439825,285282304,286331152,268439825,286330881,1048832,269549584,16781569,1048832,286326800,16842769,1048833,16842768,16843025,1048833,269549584,16847105,1048833,286326800,17826049,1048848,17891344,17829905,1048848,285278224,17830161,1048849,1114128,17891585,1048849,17891344,17895441,1048849,285278224,17895697,1052673,16842768,268501265,1052673,269549584,268505345,1052673,286326800,269484305,1052688,269549584,269488385,1052688,286326800,269549585,1052689,16842768,269549841,1052689,269549584,269553921,1052689,286326800,285216785,1114368,269549585,285216785,16781568,269549825,16781329,16847104,269549840,285216785,17891584,269549841,285216785,268505344,269553680,285216785,269549824,269553681,285216785,285217024,269553921,16781329,285282560,269553936,285216785,286327040,269553937,285217024,285217025,16781568,285282560,285217040,285217024,286327040,285217041,285217025,1114368,286326801,16843009,1114369,17891345,16846865,1114369,285278225,16847121,1114384,17891345,17829905,1114384,285278225,17830161,1114385,16842769,17891601,1114385,269549585,17895681,1114385,286326801,268505345,1118209,286326801,269488145,1118224,285278225,269488401,1118225,16842769,269549841,1118225,269549585,269553921,1118225,286326801,285217041,16843008,286327041,285217041,17830144,286327057,16781585,17895680,286330896,285217041,269549824,286330897,285217041,285278464,286331137,285217041,286265600,286331153,16781585,286331137,16843009,17891585,16846865,16843009,286327041,17829905,16843024,286327041,17891601,16843025,269549825,17895697,16846864,286327041,269549841,16846865,269549825,269553937,16847105,17891600,285278481,17895681,17895441,285278481,285282561,17895696,285278481,286331137,269549840,286330897,17891601,269549841,269553681,17895697,269553681,269553937,269553921,286330897,286265617,286331153,0,0};

// Create array to save scanned codes
const int codeMax = 20; // maximum number of scanned codes
rfCode scannedCodes[codeMax];

// Create array to save stored codes
const int storedMax = 10; // maximum number of stored codes
rfCode storedCodes[storedMax];

unsigned long debounceDelay = 50;

const int selButton = 4;
int selButtonState;
int lastSelButtonState;
unsigned long lastSelDebounceTime = 0;
int selReading;

const int navButton = 5;
int navButtonState;
int lastNavButtonState;
unsigned long lastNavDebounceTime = 0;
int navReading;
int recCount = 0; // Not 0 when we have a test code set in the scaner loop

int option = 1;
int numberOfOptions = 6;
